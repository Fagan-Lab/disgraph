context("Testing Network Distance")

MAX_ERROR <- 0.01 + 0i

### Testing Polynomial Dissimilarity ------------------------------------------------
test_that("Test Zero Quantum Jsd", {
  graph1 <- matrix(
    rbind(
      c(0, 1, 0, 0, 0, 1),
      c(0, 0, 1, 0, 0, 1),
      c(1, 1, 1, 0, 1, 1),
      c(1, 1, 1, 1, 1, 1),
      c(1, 1, 1, 0, 0, 0),
      c(1, 0, 0, 1, 1 ,0)
    ),
    nrow = 6
  )
  
  expected_rho1 <- matrix(
    rbind(
      c(1.85896644e-01, 1.86121219e-02, 9.26053116e-04, 8.40688913e-04,
        9.54676645e-04, 1.85813200e-02),
      c(1.88282576e-03, 1.85898069e-01, 1.68718800e-02, 8.40045184e-04,
         1.76389242e-03, 1.85547925e-02),
      c(1.86106971e-02, 1.86386495e-02, 1.53074745e-01, 8.15448843e-04,
         1.68733323e-02, 1.77986318e-02),
       c(1.86106971e-02, 1.86386495e-02, 1.61131443e-02, 1.37777050e-01,
         1.68733323e-02, 1.77986318e-02),
       c(1.85841696e-02, 1.94213377e-02, 1.68459962e-02, 8.32407331e-05,
         1.68214096e-01, 2.66266441e-03),
       c(1.94199129e-02, 2.71999387e-03, 1.68350130e-03, 1.52192081e-02,
         1.76294930e-02, 1.69139396e-01)
    ),
    nrow = 6
  )
  
  expected_rho2 <- matrix(
    rbind(
      c(1.85896644e-01, 1.86121219e-02, 9.26053116e-04, 8.40688913e-04,
        9.54676645e-04, 1.85813200e-02),
      c(1.88282576e-03, 1.85898069e-01, 1.68718800e-02, 8.40045184e-04,
        1.76389242e-03, 1.85547925e-02),
      c(1.86106971e-02, 1.86386495e-02, 1.53074745e-01, 8.15448843e-04,
        1.68733323e-02, 1.77986318e-02),
      c(1.86106971e-02, 1.86386495e-02, 1.61131443e-02, 1.37777050e-01,
        1.68733323e-02, 1.77986318e-02),
      c(1.85841696e-02, 1.94213377e-02, 1.68459962e-02, 8.32407331e-05,
        1.68214096e-01, 2.66266441e-03),
      c(1.94199129e-02, 2.71999387e-03, 1.68350130e-03, 1.52192081e-02,
        1.76294930e-02, 1.69139396e-01)
    ),
    nrow = 6
  )
  
  expected_mix <- matrix(
    rbind(
      c(1.85896644e-01, 1.86121219e-02, 9.26053116e-04, 8.40688913e-04,
        9.54676645e-04, 1.85813200e-02),
      c(1.88282576e-03, 1.85898069e-01, 1.68718800e-02, 8.40045184e-04,
        1.76389242e-03, 1.85547925e-02),
      c(1.86106971e-02, 1.86386495e-02, 1.53074745e-01, 8.15448843e-04,
        1.68733323e-02, 1.77986318e-02),
      c(1.86106971e-02, 1.86386495e-02, 1.61131443e-02, 1.37777050e-01,
        1.68733323e-02, 1.77986318e-02),
      c(1.85841696e-02, 1.94213377e-02, 1.68459962e-02, 8.32407331e-05,
        1.68214096e-01, 2.66266441e-03),
      c(1.94199129e-02, 2.71999387e-03, 1.68350130e-03, 1.52192081e-02,
        1.76294930e-02, 1.69139396e-01)
    ),
    nrow = 6
  )
  
  expected_H1 <- 2.547546133273845 +0i
  expected_H2 <- 2.547546133273845 + 0i
  expected_H0 <- 2.547546133273845 + 0i
  
  expected_dist <- 0 + 0i
  
  G1 <- igraph::graph_from_adjacency_matrix(graph1)
  output <- dist_quantum_jsd(G1, G1)
  expect_equal(output$density_matrix_1, expected_rho1)
  expect_equal(output$density_matrix_2, expected_rho2)
  expect_equal(output$mixture_matrix, expected_mix)
  expect_true("H1 expected Equal", all.equal(output$entropy_1, expected_H1))
  expect_true("H2 expected Equal", all.equal(output$entropy_2, expected_H2))
  expect_true("H0 expected Equal", all.equal(output$entropy_mixture, expected_H0))
  expect_equal(output$dist, expected_dist)
})
